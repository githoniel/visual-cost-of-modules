(()=>{"use strict";var e={96:(e,t,a)=>{a(6992),a(8674),a(7727);var n=a(7294),r=a(3935),s=(a(3666),a(4178)),c=(a(3948),a(8818),a(5779)),l=(a(62),a(8222)),i=(a(7940),a(817)),o=(a(5891),a(6349));const u=[{key:"dist-tags",tab:"By Tags"},{key:"versions",tab:"All Versions"}];function d({searchResult:e,setTargetVersion:t}){const[a,r]=(0,n.useState)("dist-tags"),[s,c]=(0,n.useState)(),d=e=>{c(e.target.value)},m=(0,n.useMemo)((()=>({"dist-tags":n.createElement(o.ZP.Group,{onChange:d},Object.keys(e["dist-tags"]).map((t=>{const a=e["dist-tags"][t];return n.createElement(o.ZP,{value:a,key:a},`${t}: ${a}`)}))),versions:n.createElement(o.ZP.Group,{onChange:d},Object.keys(e.versions).map((e=>n.createElement(o.ZP,{value:e,key:e},e))))})),[e]),h=e=>{r(e)},p=()=>{t(s)};return n.createElement(n.Fragment,null,n.createElement(i.Z,{style:{width:"100%",zIndex:99},title:"Choose package version",className:"version-choose",tabList:u,activeTabKey:a,onTabChange:e=>{h(e)}},n.createElement("div",{className:"version-radio"},m[a]),n.createElement("div",{className:"bottom-controller"},n.createElement("span",{className:"selected-version"},"Selected:","  ",s),n.createElement(l.Z,{type:"primary",disabled:!s,onClick:p},"Confirm"))))}a(3381);var m=a(7808),h=a(9669),p=a.n(h),g=a(5775),v=a.n(g);class E{constructor({registry:e,timeout:t}={}){this.registry="https://registry.npmjs.cf/",this.timeout=0,this.cache={},e&&(this.registry=e),t&&(this.timeout=t)}async getMetadata(e,t={}){const{version:a}=t,n=a?`${window.encodeURIComponent(e)}/${window.encodeURIComponent(a)}`:`${window.encodeURIComponent(e)}`,r=await p().get(`${this.registry}${n}`,{timeout:this.timeout});return r.data}async getDepsPkgInfo(e,t){let a;const n=`${e}@${t}`;if(this.cache[n])return this.cache[n];{a=await this.getMetadata(e);const r=Object.keys(a.versions),s="latest"===t?a["dist-tags"][t]:v()(r,t),c=a.versions[s];if(!c)throw new Error(`${n} no found in registry`);return this.cache[n]=c,c}}}function y(){const[e]=(0,n.useState)((()=>new E({registry:"https://registry.npmjs.cf/"})));return{pm:e}}const f=(0,n.createContext)(void 0),k=()=>(0,n.useContext)(f);var b;function S(){const[e,t]=(0,n.useState)(b.Idle),[a,r]=(0,n.useState)(null),{pm:s}=k(),c=(0,n.useCallback)((async e=>{t(b.Searching),r(null);try{const a=await s.getMetadata(e);r(a),t(b.Succ)}catch(a){m.ZP.error(a.message),r(a),t(b.Fail)}}),[]);return(0,n.useEffect)((()=>{e===b.Idle&&r(null)}),[e]),{searchState:e,searchResult:a,execSearch:c,setSearchResult:r,setSearchState:t}}(function(e){e[e["Idle"]=0]="Idle",e[e["Searching"]=1]="Searching",e[e["Succ"]=2]="Succ",e[e["Fail"]=3]="Fail"})(b||(b={}));const{Search:w}=c.Z;function C({setTargetName:e,setTargetVersion:t}){const{searchState:a,searchResult:r,execSearch:c,setSearchState:l}=S(),i=a=>{a&&(e(""),t(""),c(a))},o=a=>{l(b.Idle),e(r.name),t(a)};return n.createElement(s.Z.Header,null,n.createElement(w,{style:{marginTop:"15px"},placeholder:"input package name",enterButton:!0,loading:a===b.Searching,onSearch:i}),a===b.Succ&&r&&n.createElement(d,{searchResult:r,setTargetVersion:o}))}var N=a(9058),Z=a.n(N),x=a(5184),I=a.n(x),O=a(728),F=a.n(O),P=a(703),$=a.n(P);Z().use($()),Z().use(I()),Z().use(F());const T={Concentric:"concentric",FCose:"fcose",Force:"force",Cola:"cola"},j={[T.Concentric]:{name:"concentric",concentric(e){return 100-e.scratch().depLevel},levelWidth(){return 1}},[T.FCose]:{name:"fcose",quality:"proof",nodeDimensionsIncludeLabels:!0},[T.Force]:{name:"fcose",async:{maxIterations:1e3,stepsPerCycle:30,waitForStep:!1},physics:{springLength:100,springCoeff:8e-4,gravity:-1.2,theta:.8,dragCoeff:.02,timeStep:20,iterations:1e4,fit:!0,stableThreshold:9e-6},iterations:1e4,refreshInterval:16,refreshIterations:10,stableThreshold:2,animate:!0,fit:!0},[T.Cola]:{name:"cola"}};function q(){return n.createElement("div",{id:"no-thing"})}var z,L=a(7187);(function(e){e["Progress"]="progress",e["Data"]="data",e["Error"]="Error",e["End"]="end"})(z||(z={}));class B extends L.EventEmitter{dispatch(e,t){this.emit(e,t)}onEvent(e,t){return this.on(e,t),this}}const R=["#04b5e5","#ffd148","#ef7e48","#50e3c2","#42aae6"];function V(e){return R[e%R.length]}function _({pm:e,name:t,version:a}){const n=new B;return D(n,e,t,a),n}async function D(e,t,a,n){e.dispatch(z.Progress,{count:1,level:0});const r=await t.getMetadata(a,{version:n}),s=H(r,0),c=s.data.id;e.dispatch(z.Data,{nodes:[s],edges:[]});const l={level:1,taskHistory:{[c]:!0},task:G(c,r.dependencies)};M(e,t,l)}async function M(e,t,a){const n=a.task,r=a.level;a.task=[],a.level+=1;const s=[],c=[];e.dispatch(z.Progress,{count:n.length,level:r}),await Promise.all(n.map((async({name:e,requiredVersion:n,requiredBy:l})=>{const i=await t.getDepsPkgInfo(e,n),o=H(i,r),u=o.data.id;a.taskHistory[u]||(a.taskHistory[u]=!0,s.push(o),a.task=[...a.task,...G(u,i.dependencies,a.taskHistory)]),c.push({data:{id:`${u} -> ${l}`,source:u,target:l}})}))).catch((t=>{throw e.dispatch(z.Error,t),t})),e.dispatch(z.Data,{nodes:s,edges:c}),a.task.length>0?M(e,t,a):(a.taskHistory={},e.dispatch(z.End))}function H(e,t){e.dist.size=e.dist.size||e.dist.unpackedSize;const a=`${e.name}@${e.version}`,n=Math.max(e.dist.size/20480,5);return{data:{id:a},scratch:{displaySize:n,depLevel:t,detail:e},style:{height:n,width:n,"background-color":V(t)}}}function G(e,t,a={}){return t?Object.keys(t).map((n=>{if(a[n])return null;const r=t[n];return{name:n,requiredVersion:r,requiredBy:e}})).filter(U):[]}function U(e){return null!==e&&void 0!==e}a(4346);var K=a(6772);function A({message:e,status:t}){let a;switch(t){case b.Searching:a="info";break;case b.Succ:a="success";break;case b.Fail:a="error";break}return n.createElement(n.Fragment,null,a&&n.createElement(K.Z,{message:e,type:a}))}var W=a(4549),J=a(8600),Q=a.n(J);function X({info:e,cyInstance:t}){const[a,r]=(0,n.useState)(!1);(0,n.useEffect)((()=>{e&&r(!0)}),[e]);const s=()=>{r(!1)},c=!!e.detail,o=e,u=e,d=e=>{if(t){const a=t.getElementById(e);a&&t.fit(a)}};return n.createElement(n.Fragment,null,a&&n.createElement(i.Z,{size:"small",className:"pkg-info-card",title:c?o.detail.name:"Dependency",extra:n.createElement(l.Z,{type:"text",shape:"circle",icon:n.createElement(W.Z,{onClick:s})})},c?n.createElement(n.Fragment,null,n.createElement("p",{className:"line"},n.createElement("div",{className:"title"},"version"),n.createElement("div",{className:"value"},o.detail.version)),n.createElement("p",{className:"line"},n.createElement("div",{className:"title"},"size"),n.createElement("div",{className:"value"},Q()(o.detail.dist.size||0))),n.createElement("p",{className:"line"},n.createElement("div",{className:"title"},"tarball"),n.createElement("div",{className:"value"},n.createElement("a",{href:o.detail.dist.tarball},"click to download"))),n.createElement("p",{className:"line"},n.createElement("div",{className:"title"},"npm page"),n.createElement("div",{className:"value"},n.createElement("a",{href:`https://www.npmjs.com/${o.detail.name}`,target:"_blank",rel:"noreferrer"},"click to visite"))),n.createElement("p",{className:"line"},n.createElement("div",{className:"title"},"require"),n.createElement("div",{className:"value"},o.requirePkg.map((e=>n.createElement(l.Z,{type:"text",onClick:()=>d(e)},e))))),n.createElement("p",{className:"line"},n.createElement("div",{className:"title"},"required by"),n.createElement("div",{className:"value"},o.requiredByPkg.map((e=>n.createElement(l.Z,{type:"text",onClick:()=>d(e)},e)))))):n.createElement(n.Fragment,null,n.createElement("p",{className:"line"},n.createElement("div",{className:"title"},"package"),n.createElement("div",{className:"value"},n.createElement(l.Z,{type:"text",onClick:()=>d(u.source)},u.source))),n.createElement("p",{className:"line"},n.createElement("div",{className:"title"},"required by"),n.createElement("div",{className:"value"},n.createElement(l.Z,{type:"text",onClick:()=>d(u.target)},u.target))))))}function Y({name:e,version:t,layoutOption:a,cyInstance:r,setCyInstance:s}){const[c,l]=(0,n.useState)("Loading"),[i,o]=(0,n.useState)(b.Idle),[u,d]=(0,n.useState)(),{pm:m}=k();return(0,n.useEffect)((()=>{const n=Z()({container:document.getElementById("dep-graph"),elements:{nodes:[]},style:[{selector:"node",style:{label:"data(id)","font-size":"6px",color:"#333","text-valign":"center","text-halign":"right",shape:"ellipse"}},{selector:"node:selected",style:{"border-width":"1","border-color":"red","border-style":"solid"}},{selector:"edge",style:{width:.5,"line-color":"#ccc","font-size":"6px","target-arrow-color":"#ccc","target-arrow-shape":"triangle-backcurve","curve-style":"bezier","arrow-scale":.5}},{selector:"edge:selected",style:{"line-color":"red",width:1}}]}),r=_({pm:m,name:e,version:t});return r.onEvent(z.Error,(e=>{o(b.Fail),l(e.stack||e.message)})).onEvent(z.Progress,(e=>{o(b.Searching),l(`Loading ${e.count} dependencies of the ${e.level+1} level...`)})).onEvent(z.End,(()=>{o(b.Succ),l("Load dependencies done"),n.elements().off("click").on("click",(e=>{const{target:t}=e;if(t.isEdge())d({source:t.source().data().id,target:t.target().data().id});else if(t.isNode()){const e=t.scratch(),{id:a}=t.data(),n=[],r=[];t.connectedEdges().forEach((e=>{const t=e.source().data().id,s=e.target().data().id;t===a?r.push(s):n.push(t)})),console.dir(e),d({...e,requirePkg:n,requiredByPkg:r})}}))})).onEvent(z.Data,(e=>{n.add(e),n.layout(a).run()})),s(n),()=>{n.unmount(),s(void 0)}}),[]),n.createElement(n.Fragment,null,n.createElement(A,{message:c,status:i}),u&&n.createElement(X,{info:u,cyInstance:r}),n.createElement("div",{id:"dep-graph"}))}a(9793);var ee=a(144),te=a(4616);const{Option:ae}=ee.Z;function ne({layoutOption:e,setLayoutOption:t,cyInstance:a}){const{pm:r}=k(),[s,o]=(0,n.useState)(!1),u=()=>{o(!0)},d=()=>{o(!1)};function m(e){t(j[e]),a&&a.layout(j[e]).run()}const h=()=>{if(a){const e=a.elements()[0];a.fit(e,100)}};return n.createElement(n.Fragment,null,n.createElement("div",{className:"draw-opener"},n.createElement(l.Z,{type:"text",shape:"circle",icon:n.createElement(te.Z,{onClick:u})})),s&&n.createElement(i.Z,{className:"draw-setting",size:"small",title:"Graph",extra:n.createElement(l.Z,{type:"text",shape:"circle",icon:n.createElement(W.Z,{onClick:d})}),style:{width:400}},n.createElement("div",null,n.createElement(c.Z.Search,{placeholder:"输入搜索文本",defaultValue:r.registry,enterButton:"OK",onSearch:e=>{r.registry=e,r.cache={}}})),n.createElement("br",null),n.createElement("div",null,n.createElement("span",null,"Layout:"),n.createElement(ee.Z,{defaultValue:e.name,style:{width:120},onChange:m},Object.keys(T).map((e=>n.createElement(ae,{value:T[e],key:e},e))))),n.createElement("br",null),n.createElement("div",null,n.createElement(l.Z,{onClick:h},"GoTo Root"))))}function re({name:e,version:t}){const[a,r]=(0,n.useState)(j[T.FCose]),[s,c]=(0,n.useState)();return n.createElement(n.Fragment,null,n.createElement(ne,{layoutOption:a,setLayoutOption:r,cyInstance:s}),e&&t?n.createElement(Y,{name:e,version:t,layoutOption:a,cyInstance:s,setCyInstance:c}):n.createElement(q,null))}function se(){const[e,t]=(0,n.useState)(""),[a,r]=(0,n.useState)("");return n.createElement(f.Provider,{value:y()},n.createElement(s.Z,{style:{height:"100vh"}},n.createElement(C,{setTargetName:t,setTargetVersion:r}),n.createElement(s.Z.Content,null,n.createElement(re,{name:e,version:a}))))}(0,r.render)(n.createElement(se,null),document.querySelector("#root"))}},t={};function a(n){var r=t[n];if(void 0!==r)return r.exports;var s=t[n]={exports:{}};return e[n].call(s.exports,s,s.exports,a),s.exports}a.m=e,(()=>{var e=[];a.O=(t,n,r,s)=>{if(!n){var c=1/0;for(u=0;u<e.length;u++){for(var[n,r,s]=e[u],l=!0,i=0;i<n.length;i++)(!1&s||c>=s)&&Object.keys(a.O).every((e=>a.O[e](n[i])))?n.splice(i--,1):(l=!1,s<c&&(c=s));if(l){e.splice(u--,1);var o=r();void 0!==o&&(t=o)}}return t}s=s||0;for(var u=e.length;u>0&&e[u-1][2]>s;u--)e[u]=e[u-1];e[u]=[n,r,s]}})(),(()=>{a.n=e=>{var t=e&&e.__esModule?()=>e["default"]:()=>e;return a.d(t,{a:t}),t}})(),(()=>{a.d=(e,t)=>{for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}})(),(()=>{a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()})(),(()=>{a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t)})(),(()=>{var e={143:0};a.O.j=t=>0===e[t];var t=(t,n)=>{var r,s,[c,l,i]=n,o=0;for(r in l)a.o(l,r)&&(a.m[r]=l[r]);if(i)var u=i(a);for(t&&t(n);o<c.length;o++)s=c[o],a.o(e,s)&&e[s]&&e[s][0](),e[c[o]]=0;return a.O(u)},n=self["webpackChunkvisual_cost_of_modules"]=self["webpackChunkvisual_cost_of_modules"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var n=a.O(void 0,[998],(()=>a(96)));n=a.O(n)})();